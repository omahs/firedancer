---
- name: Set solana keygen binary
  ansible.builtin.set_fact:
    labs_keygen: "{{ labs_workdir }}/solana-keygen"

- name: Create keys directory
  ansible.builtin.file:
    path: "{{ labs_keys_dir }}"
    state: directory

- name: Create mint key and staking authority
  ansible.builtin.command: "{{ labs_keygen }} new --no-bip39-passphrase -o {{ item }}"
  args:
    creates: "{{ item }}"
  loop:
  - "{{ labs_faucet }}"
  - "{{ labs_authority }}"

- name: Create bootstrap validator keys
  ansible.builtin.shell: "{{ labs_keygen }} new --no-bip39-passphrase --force -o {{ labs_keys_dir }}/{{ item }}.json > {{ labs_keys_dir }}/{{ item }}.seed"
  args:
    creates:
      - "{{ labs_keys_dir }}/{{ item }}.json"
      - "{{ labs_keys_dir }}/{{ item }}.seed"
  loop:
  - "id"
  - "vote"
  - "stake"
